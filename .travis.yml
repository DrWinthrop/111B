# Need "trusty" Linux distribution for recent versions of texlive and latexmk
dist: trusty

# Superuser privileges required to install texlive and latexmk
sudo: required

# Add Pantheon server to known hosts, so it doesn't ask if we want to trust it
# when transferring files.
addons:
  ssh_known_hosts: appserver.live.0bc915fe-2126-4798-9621-fdf6aa78ed57.drush.in:2222

# Only build master branch. ShareLaTeX creates additional branches when pulling
# changes from GitHub.
branches:
  only:
    - master

before_install:
# Install LaTeX: texlive and latexmk for compiling PDFs
- sudo apt-get update && sudo apt-get install --no-install-recommends
  texlive-fonts-recommended texlive-latex-extra texlive-fonts-extra
  texlive-latex-recommended dvipng latexmk

# Decrypt key (this command is generated by Travis)
- openssl aes-256-cbc -K $encrypted_4e95ee74cb04_key
  -iv $encrypted_4e95ee74cb04_iv -in deploy_rsa.enc -out /tmp/deploy_rsa -d

# Set SSH agent environment variables
- eval "$(ssh-agent -s)"

# Allow read/write of RSA file
- chmod 600 /tmp/deploy_rsa

# Add key identity to this agent
- ssh-add /tmp/deploy_rsa

# Run Python script
script:
- python create.py

# Don't email anyone results of this build
notifications:
  email: false
